const popupElement=document.querySelector(".popup_wrapper"),landingWrapper=document.querySelector(".landing_wrapper"),formWrapper=document.querySelector(".form_wrapper"),successWrapper=document.querySelector(".success_wrapper"),cross=document.querySelector(".cross"),email=document.querySelector(".form_email"),password=document.querySelector(".form_password"),emailMessage=document.querySelector(".email_message"),passwordMessage=document.querySelector(".password_message"),emailErrIcon=document.querySelector(".email_error-icon"),passwordErrIcon=document.querySelector(".password_error-icon"),url="https://api.dating.com/identity",showPopup=async()=>{landingWrapper.classList.add("blurred"),popupElement.classList.remove("no-show")},closePopup=()=>{landingWrapper.classList.remove("blurred"),popupElement.classList.add("no-show"),clearSuccessState()},redirectUserToDatingPage=e=>{window.location=`https://www.dating.com/people/#token=${sessionID}`},isPopupClosed=()=>popupElement.classList.contains("no-show"),setInputError=e=>{"email"===e&&(email.classList.add("form_email-error"),emailErrIcon.classList.remove("no-show"),emailMessage.classList.remove("no-show")),"password"===e&&(password.classList.add("form_password-error"),passwordErrIcon.classList.remove("no-show"),passwordMessage.classList.remove("no-show"))},displaySuccessWindow=()=>{formWrapper.classList.add("hidden"),successWrapper.classList.remove("hidden")},clearSuccessState=()=>{successWrapper.classList.add("hidden"),formWrapper.classList.remove("hidden"),email.value="",password.value=""},areFormsValid=()=>{if(email.validity.valid&&password.value.length>=8)return!0},getSessionID=()=>Object.fromEntries(document.cookie.split("; ").map(e=>e.split("="))).SESSION_ID;document.addEventListener("click",async e=>{const s=getSessionID();if(e.target.classList.contains("landing_item-wrapper_signup-button")&&(s&&redirectUserToDatingPage(),showPopup()),e.target.classList.contains("cross")&&closePopup(),e.target.classList.contains("form_submit")&&(email.validity.valid||setInputError("email"),password.value.length<8&&0!==password.value.length&&setInputError("password"),areFormsValid()))try{const e=(await fetch(url,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:email.value,password:password.value})})).headers.get("X-Token");e&&(document.cookie=`SESSION_ID = ${e}`,displaySuccessWindow(),setTimeout(()=>{redirectUserToDatingPage()},5e3))}catch(e){console.log(e)}}),document.addEventListener("keyup",e=>{"Escape"!==e.key||isPopupClosed()||closePopup()});